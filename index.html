<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Яндекс.Дом - умный дом для вашего комфорта"
    />
    <title>Яндекс.Дом</title>
    <link rel="preconnect" href="https://unpkg.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      as="font"
      href="assets/lato.woff2"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link rel="preload" href="assets/logo.svg" as="image" />
    <link
      rel="preload"
      href="assets/bg.webp"
      as="image"
      media="(min-width: 769px)"
    />
    <style>
      /* Critical CSS - минимизированная версия необходимых стилей */
      html {
        font-family: Arial, sans-serif;
        line-height: 1.25;
      }
      body {
        display: flex;
        flex-direction: column;
        margin: 0;
        min-height: 100vh;
      }
      .main {
        display: grid;
        flex: 0 0 auto;
        grid-template-columns: 50% 50%;
        gap: 1.625rem;
        padding: 0 2.5rem;
      }
      .header {
        position: relative;
        display: flex;
        align-items: center;
        height: 5.75rem;
        margin-bottom: 1.875rem;
        padding: 0 2.5rem;
        border-bottom: 1px solid #f0f0f0;
      }
      .header__logo {
        flex: 0 0 auto;
        width: 6.75rem;
        height: 2.3125rem;
        margin-right: 3.25rem;
        background: no-repeat 50% 50% / contain url(assets/logo.svg);
      }
      .footer {
        display: flex;
        align-items: center;
        height: 4rem;
        margin-top: auto;
        padding: 0 2.5rem;
      }
      .a11y-hidden {
        position: absolute;
        height: 1px;
        width: 1px;
        top: 0;
        overflow: hidden;
        clip: rect(1px 1px 1px 1px);
      }
      .main__devices {
        grid-column: 1/3;
      }
      @media (max-width: 1024px) {
        .main {
          grid-template-columns: 100%;
        }
        .main__devices {
          grid-column-end: 2;
        }
      }
      @media (max-width: 768px) {
        .header {
          height: 4rem;
          margin-bottom: 0;
          padding-left: 1.25rem;
          border-bottom: none;
        }
        .main {
          padding: 0 1.25rem;
        }
      }
    </style>
    <link
      rel="stylesheet"
      href="styles.min.css"
      media="print"
      onload="this.media='all'"
    />
    <noscript><link rel="stylesheet" href="styles.min.css" /></noscript>
  </head>
  <body>
    <div id="app"></div>

    <footer class="footer">
      <ul class="footer__list">
        <li class="footer__item">
          <a class="footer__link" href="/">Помощь</a>
        </li>
        <li class="footer__item">
          <a class="footer__link" href="/">Обратная связь</a>
        </li>
        <li class="footer__item">
          <a class="footer__link" href="/">Разработчикам</a>
        </li>
        <li class="footer__item">
          <a class="footer__link" href="/">Условия использования</a>
        </li>
      </ul>

      <div class="footer__copyright">© 1997–2023 ООО «Яндекс»</div>
    </footer>

    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script>
      // Вынесенные React компоненты
      const Header = () => {
        const [expanded, setExpanded] = React.useState(false);
        const [toggled, setToggled] = React.useState(false);

        const onClick = () => {
          if (!toggled) setToggled(true);
          setExpanded(!expanded);
        };

        return React.createElement(
          "header",
          { className: "header" },
          React.createElement("a", {
            href: "/",
            className: "header__logo",
            "aria-label": "Яндекс.Дом",
          }),
          React.createElement(
            "button",
            {
              className: "header__menu",
              "aria-expanded": expanded ? "true" : "false",
              onClick: onClick,
            },
            React.createElement(
              "span",
              { className: "header__menu-text a11y-hidden" },
              expanded ? "Закрыть меню" : "Открыть меню"
            )
          ),
          React.createElement(
            "ul",
            {
              className: `header__links${
                expanded ? " header__links_opened" : ""
              }${toggled ? " header__links-toggled" : ""}`,
            },
            React.createElement(
              "li",
              { className: "header__item" },
              React.createElement(
                "a",
                {
                  className: "header__link header__link_current",
                  href: "/",
                  "aria-current": "page",
                },
                "Сводка"
              )
            ),
            React.createElement(
              "li",
              { className: "header__item" },
              React.createElement(
                "a",
                { className: "header__link", href: "/devices" },
                "Устройства"
              )
            ),
            React.createElement(
              "li",
              { className: "header__item" },
              React.createElement(
                "a",
                { className: "header__link", href: "/scripts" },
                "Сценарии"
              )
            )
          )
        );
      };

      const Event = React.memo((props) => {
        const ref = React.useRef();

        React.useEffect(() => {
          if (props.onSize) {
            const width = ref.current.offsetWidth;
            const height = ref.current.offsetHeight;
            props.onSize({ width, height });
          }
        });

        return React.createElement(
          "li",
          {
            ref: ref,
            className: "event" + (props.slim ? " event_slim" : ""),
          },
          React.createElement(
            "button",
            { className: "event__button" },
            React.createElement("span", {
              className: `event__icon event__icon_${props.icon}`,
              role: "img",
              "aria-label": props.iconLabel,
            }),
            React.createElement(
              "h4",
              { className: "event__title" },
              props.title
            ),
            props.subtitle &&
              React.createElement(
                "span",
                { className: "event__subtitle" },
                props.subtitle
              )
          )
        );
      });

      const TABS = {
        all: {
          title: "Все",
          items: [
            {
              icon: "light2",
              iconLabel: "Освещение",
              title: "Xiaomi Yeelight LED Smart Bulb",
              subtitle: "Включено",
            },
            {
              icon: "light",
              iconLabel: "Освещение",
              title: "D-Link Omna 180 Cam",
              subtitle: "Включится в 17:00",
            },
            {
              icon: "temp",
              iconLabel: "Температура",
              title: "Elgato Eve Degree Connected",
              subtitle: "Выключено до 17:00",
            },
            {
              icon: "light",
              iconLabel: "Освещение",
              title: "LIFX Mini Day & Dusk A60 E27",
              subtitle: "Включится в 17:00",
            },
            {
              icon: "light2",
              iconLabel: "Освещение",
              title: "Xiaomi Mi Air Purifier 2S",
              subtitle: "Включено",
            },
            {
              icon: "light",
              iconLabel: "Освещение",
              title: "Philips Zhirui",
              subtitle: "Включено",
            },
          ],
        },
        kitchen: {
          title: "Кухня",
          items: [
            {
              icon: "light2",
              iconLabel: "Освещение",
              title: "Xiaomi Yeelight LED Smart Bulb",
              subtitle: "Включено",
            },
            {
              icon: "temp",
              iconLabel: "Температура",
              title: "Elgato Eve Degree Connected",
              subtitle: "Выключено до 17:00",
            },
          ],
        },
        hall: {
          title: "Зал",
          items: [
            {
              icon: "light",
              iconLabel: "Освещение",
              title: "Philips Zhirui",
              subtitle: "Выключено",
            },
            {
              icon: "light2",
              iconLabel: "Освещение",
              title: "Xiaomi Mi Air Purifier 2S",
              subtitle: "Выключено",
            },
          ],
        },
        lights: {
          title: "Лампочки",
          items: [
            {
              icon: "light",
              iconLabel: "Освещение",
              title: "D-Link Omna 180 Cam",
              subtitle: "Включится в 17:00",
            },
            {
              icon: "light",
              iconLabel: "Освещение",
              title: "LIFX Mini Day & Dusk A60 E27",
              subtitle: "Включится в 17:00",
            },
            {
              icon: "light2",
              iconLabel: "Освещение",
              title: "Xiaomi Mi Air Purifier 2S",
              subtitle: "Включено",
            },
            {
              icon: "light",
              iconLabel: "Освещение",
              title: "Philips Zhirui",
              subtitle: "Включено",
            },
          ],
        },
        cameras: {
          title: "Камеры",
          items: [
            {
              icon: "light2",
              iconLabel: "Освещение",
              title: "Xiaomi Mi Air Purifier 2S",
              subtitle: "Включено",
            },
          ],
        },
      };

      // Виртуализация списка для больших данных
      const VirtualizedList = ({ items }) => {
        const containerRef = React.useRef();
        const [visibleItems, setVisibleItems] = React.useState(10);

        React.useEffect(() => {
          const observer = new IntersectionObserver(
            (entries) => {
              if (entries[0].isIntersecting) {
                setVisibleItems((prev) => Math.min(prev + 10, items.length));
              }
            },
            { threshold: 0.1 }
          );

          if (containerRef.current) {
            observer.observe(containerRef.current);
          }

          return () => observer.disconnect();
        }, [items.length]);

        return React.createElement(
          "ul",
          { className: "section__panel-list" },
          items.slice(0, visibleItems).map((item, index) =>
            React.createElement(Event, {
              key: index,
              ...item,
              onSize: () => {},
            })
          ),
          visibleItems < items.length &&
            React.createElement("li", {
              ref: containerRef,
              style: { height: "1px", visibility: "hidden" },
            })
        );
      };

      const Main = () => {
        const [activeTab, setActiveTab] = React.useState("all");
        const [hasRightScroll, setHasRightScroll] = React.useState(false);
        const panelRef = React.useRef();

        React.useEffect(() => {
          const tab = new URLSearchParams(location.search).get("tab");
          if (tab && TABS[tab]) setActiveTab(tab);
        }, []);

        const onSelectInput = (event) => setActiveTab(event.target.value);
        const onArrowClick = () => {
          const scroller = panelRef.current?.querySelector(
            ".section__panel:not(.section__panel_hidden)"
          );
          if (scroller) {
            scroller.scrollTo({
              left: scroller.scrollLeft + 400,
              behavior: "smooth",
            });
          }
        };

        return React.createElement(
          "main",
          { className: "main" },
          React.createElement(
            "section",
            { className: "section main__general" },
            React.createElement(
              "h2",
              {
                className:
                  "section__title section__title-header section__main-title",
              },
              "Главное"
            ),
            React.createElement(
              "div",
              { className: "hero-dashboard" },
              React.createElement(
                "div",
                { className: "hero-dashboard__primary" },
                React.createElement(
                  "h3",
                  { className: "hero-dashboard__title" },
                  "Привет, Геннадий!"
                ),
                React.createElement(
                  "p",
                  { className: "hero-dashboard__subtitle" },
                  "Двери и окна закрыты, сигнализация включена."
                ),
                React.createElement(
                  "ul",
                  { className: "hero-dashboard__info" },
                  React.createElement(
                    "li",
                    { className: "hero-dashboard__item" },
                    React.createElement(
                      "div",
                      { className: "hero-dashboard__item-title" },
                      "Дома"
                    ),
                    React.createElement(
                      "div",
                      { className: "hero-dashboard__item-details" },
                      "+23",
                      React.createElement(
                        "span",
                        { className: "a11y-hidden" },
                        "°"
                      )
                    )
                  ),
                  React.createElement(
                    "li",
                    { className: "hero-dashboard__item" },
                    React.createElement(
                      "div",
                      { className: "hero-dashboard__item-title" },
                      "За окном"
                    ),
                    React.createElement(
                      "div",
                      { className: "hero-dashboard__item-details" },
                      "+19",
                      React.createElement(
                        "span",
                        { className: "a11y-hidden" },
                        "°"
                      ),
                      React.createElement("div", {
                        className:
                          "hero-dashboard__icon hero-dashboard__icon_rain",
                        role: "img",
                        "aria-label": "Дождь",
                      })
                    )
                  )
                )
              ),
              React.createElement(
                "ul",
                { className: "hero-dashboard__schedule" },
                React.createElement(Event, {
                  icon: "temp",
                  iconLabel: "Температура",
                  title: "Philips Cooler",
                  subtitle: "Начнет охлаждать в 16:30",
                }),
                React.createElement(Event, {
                  icon: "light",
                  iconLabel: "Освещение",
                  title: "Xiaomi Yeelight LED Smart Bulb",
                  subtitle: "Включится в 17:00",
                }),
                React.createElement(Event, {
                  icon: "light",
                  iconLabel: "Освещение",
                  title: "Xiaomi Yeelight LED Smart Bulb",
                  subtitle: "Включится в 17:00",
                })
              )
            )
          ),
          React.createElement(
            "section",
            { className: "section main__scripts" },
            React.createElement(
              "h2",
              { className: "section__title section__title-header" },
              "Избранные сценарии"
            ),
            React.createElement(
              "ul",
              { className: "event-grid" },
              React.createElement(Event, {
                slim: true,
                icon: "light2",
                iconLabel: "Освещение",
                title: "Выключить весь свет в доме и во дворе",
              }),
              React.createElement(Event, {
                slim: true,
                icon: "schedule",
                iconLabel: "Расписание",
                title: "Я ухожу",
              }),
              React.createElement(Event, {
                slim: true,
                icon: "light2",
                iconLabel: "Освещение",
                title: "Включить свет в коридоре",
              }),
              React.createElement(Event, {
                slim: true,
                icon: "temp2",
                iconLabel: "Температура",
                title: "Набрать горячую ванну",
                subtitle: "Начнётся в 18:00",
              }),
              React.createElement(Event, {
                slim: true,
                icon: "temp2",
                iconLabel: "Температура",
                title: "Сделать пол тёплым во всей квартире",
              })
            )
          ),
          React.createElement(
            "section",
            { className: "section main__devices" },
            React.createElement(
              "div",
              { className: "section__title" },
              React.createElement(
                "h2",
                { className: "section__title-header" },
                "Избранные устройства"
              ),
              React.createElement(
                "select",
                {
                  className: "section__select",
                  defaultValue: activeTab,
                  onInput: onSelectInput,
                },
                Object.keys(TABS).map((key) =>
                  React.createElement(
                    "option",
                    { key: key, value: key },
                    TABS[key].title
                  )
                )
              ),
              React.createElement(
                "ul",
                { role: "tablist", className: "section__tabs" },
                Object.keys(TABS).map((key) =>
                  React.createElement(
                    "li",
                    {
                      key: key,
                      role: "tab",
                      "aria-selected": key === activeTab ? "true" : "false",
                      tabIndex: key === activeTab ? "0" : undefined,
                      className:
                        "section__tab" +
                        (key === activeTab ? " section__tab_active" : ""),
                      id: `tab_${key}`,
                      "aria-controls": `panel_${key}`,
                      onClick: () => setActiveTab(key),
                    },
                    TABS[key].title
                  )
                )
              )
            ),
            React.createElement(
              "div",
              { className: "section__panel-wrapper", ref: panelRef },
              Object.keys(TABS).map((key) =>
                React.createElement(
                  "div",
                  {
                    key: key,
                    role: "tabpanel",
                    className:
                      "section__panel" +
                      (key === activeTab ? "" : " section__panel_hidden"),
                    "aria-hidden": key === activeTab ? "false" : "true",
                    id: `panel_${key}`,
                    "aria-labelledby": `tab_${key}`,
                  },
                  React.createElement(VirtualizedList, {
                    items: TABS[key].items,
                  })
                )
              ),
              hasRightScroll &&
                React.createElement("div", {
                  className: "section__arrow",
                  onClick: onArrowClick,
                })
            )
          )
        );
      };

      // Рендеринг приложения без задержки
      document.addEventListener("DOMContentLoaded", () => {
        const root = ReactDOM.createRoot(document.getElementById("app"));
        root.render(
          React.createElement(
            React.Fragment,
            null,
            React.createElement(Header),
            React.createElement(Main)
          )
        );
      });
    </script>
  </body>
</html>
